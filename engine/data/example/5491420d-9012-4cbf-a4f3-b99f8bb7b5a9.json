{"id":"5491420d-9012-4cbf-a4f3-b99f8bb7b5a9","name":"6. Multi-participant Voice AI","created_at":"2025-10-15T11:33:24.248764","updated_at":"2025-10-15T12:09:14.974431","graph":{"nodes":[{"id":"publish_3418cd0e","type":"Publish","editor_name":"Alice Input","editor_position":[180.0,456.0],"editor_dimensions":[256.0,424.0],"pads":[{"id":"audio","group":"audio","type":"StatelessSourcePad","default_allowed_types":[{"type":"audio"}],"allowed_types":[{"type":"audio"}],"value":null,"next_pads":[{"node":"multiparticipantstt_4b02c382","pad":"audio_0"}],"previous_pad":null,"pad_links":[]},{"id":"video","group":"video","type":"StatelessSourcePad","default_allowed_types":[{"type":"video"}],"allowed_types":[{"type":"video"}],"value":null,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"audio_enabled","group":"audio_enabled","type":"PropertySourcePad","default_allowed_types":[{"type":"boolean"}],"allowed_types":[{"type":"boolean"}],"value":false,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"video_enabled","group":"video_enabled","type":"PropertySourcePad","default_allowed_types":[{"type":"boolean"}],"allowed_types":[{"type":"boolean"}],"value":false,"next_pads":[],"previous_pad":null,"pad_links":[]}],"description":"Stream audio and video into your Gabber flow","metadata":{"primary":"core","secondary":"media","tags":["input","stream"]},"notes":[]},{"id":"publish_b6bbe99a","type":"Publish","editor_name":"Bob Input","editor_position":[192.0,912.0],"editor_dimensions":[256.0,424.0],"pads":[{"id":"audio","group":"audio","type":"StatelessSourcePad","default_allowed_types":[{"type":"audio"}],"allowed_types":[{"type":"audio"}],"value":null,"next_pads":[{"node":"multiparticipantstt_4b02c382","pad":"audio_1"}],"previous_pad":null,"pad_links":[]},{"id":"video","group":"video","type":"StatelessSourcePad","default_allowed_types":[{"type":"video"}],"allowed_types":[{"type":"video"}],"value":null,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"audio_enabled","group":"audio_enabled","type":"PropertySourcePad","default_allowed_types":[{"type":"boolean"}],"allowed_types":[{"type":"boolean"}],"value":false,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"video_enabled","group":"video_enabled","type":"PropertySourcePad","default_allowed_types":[{"type":"boolean"}],"allowed_types":[{"type":"boolean"}],"value":false,"next_pads":[],"previous_pad":null,"pad_links":[]}],"description":"Stream audio and video into your Gabber flow","metadata":{"primary":"core","secondary":"media","tags":["input","stream"]},"notes":[]},{"id":"multiparticipantstt_4b02c382","type":"MultiParticipantSTT","editor_name":"MultiParticipantSTT","editor_position":[552.0,552.0],"editor_dimensions":[309.0,517.0],"pads":[{"id":"current_state","group":"current_state","type":"PropertySourcePad","default_allowed_types":[{"type":"enum","options":["WAITING_FOR_HUMAN","TALKING","COOLDOWN","AI_CAN_TALK"]}],"allowed_types":[{"type":"enum","options":["WAITING_FOR_HUMAN","TALKING","COOLDOWN","AI_CAN_TALK"]}],"value":"WAITING_FOR_HUMAN","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"previous_state","group":"previous_state","type":"PropertySourcePad","default_allowed_types":[{"type":"enum","options":["WAITING_FOR_HUMAN","TALKING","COOLDOWN","AI_CAN_TALK"]}],"allowed_types":[{"type":"enum","options":["WAITING_FOR_HUMAN","TALKING","COOLDOWN","AI_CAN_TALK"]}],"value":"WAITING_FOR_HUMAN","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"service","group":"service","type":"PropertySinkPad","default_allowed_types":[{"type":"enum","options":["assembly_ai","local_kyutai","deepgram"]}],"allowed_types":[{"type":"enum","options":["assembly_ai","local_kyutai","deepgram"]}],"value":"assembly_ai","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"api_key","group":"api_key","type":"PropertySinkPad","default_allowed_types":[{"type":"secret","options":[{"updated_at":"2025-10-15T12:07:04.482697","created_at":"2025-10-15T12:07:04.482701","id":"EXAMPLE_SECRET","name":"EXAMPLE_SECRET"},{"updated_at":"2025-10-15T12:07:04.482859","created_at":"2025-10-15T12:07:04.482860","id":"OPEN_AI_API_KEY","name":"OPEN_AI_API_KEY"},{"updated_at":"2025-10-15T12:07:04.482862","created_at":"2025-10-15T12:07:04.482862","id":"GABBER_API_KEY","name":"GABBER_API_KEY"},{"updated_at":"2025-10-15T12:07:04.482864","created_at":"2025-10-15T12:07:04.482864","id":"ASSEMBLY_API_KEY","name":"ASSEMBLY_API_KEY"},{"updated_at":"2025-10-15T12:07:04.482865","created_at":"2025-10-15T12:07:04.482866","id":"SPOTIFY_API_KEY","name":"SPOTIFY_API_KEY"},{"updated_at":"2025-10-15T12:07:04.482867","created_at":"2025-10-15T12:07:04.482867","id":"GOOGLE_DOCS_KEY","name":"GOOGLE_DOCS_KEY"},{"updated_at":"2025-10-15T12:07:04.482869","created_at":"2025-10-15T12:07:04.482870","id":"ELEVEN_LABS_API_KEY","name":"ELEVEN_LABS_API_KEY"},{"updated_at":"2025-10-15T12:07:04.482871","created_at":"2025-10-15T12:07:04.482871","id":"CARTESIA_API_KEY","name":"CARTESIA_API_KEY"}]}],"allowed_types":[{"type":"secret","options":[{"updated_at":"2025-10-15T12:07:04.482697","created_at":"2025-10-15T12:07:04.482701","id":"EXAMPLE_SECRET","name":"EXAMPLE_SECRET"},{"updated_at":"2025-10-15T12:07:04.482859","created_at":"2025-10-15T12:07:04.482860","id":"OPEN_AI_API_KEY","name":"OPEN_AI_API_KEY"},{"updated_at":"2025-10-15T12:07:04.482862","created_at":"2025-10-15T12:07:04.482862","id":"GABBER_API_KEY","name":"GABBER_API_KEY"},{"updated_at":"2025-10-15T12:07:04.482864","created_at":"2025-10-15T12:07:04.482864","id":"ASSEMBLY_API_KEY","name":"ASSEMBLY_API_KEY"},{"updated_at":"2025-10-15T12:07:04.482865","created_at":"2025-10-15T12:07:04.482866","id":"SPOTIFY_API_KEY","name":"SPOTIFY_API_KEY"},{"updated_at":"2025-10-15T12:07:04.482867","created_at":"2025-10-15T12:07:04.482867","id":"GOOGLE_DOCS_KEY","name":"GOOGLE_DOCS_KEY"},{"updated_at":"2025-10-15T12:07:04.482869","created_at":"2025-10-15T12:07:04.482870","id":"ELEVEN_LABS_API_KEY","name":"ELEVEN_LABS_API_KEY"},{"updated_at":"2025-10-15T12:07:04.482871","created_at":"2025-10-15T12:07:04.482871","id":"CARTESIA_API_KEY","name":"CARTESIA_API_KEY"}]}],"value":"ASSEMBLY_API_KEY","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"num_participants","group":"num_participants","type":"PropertySinkPad","default_allowed_types":[{"type":"integer","maximum":null,"minimum":null}],"allowed_types":[{"type":"integer","maximum":null,"minimum":null}],"value":2,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"cooldown_time_ms","group":"cooldown_time_ms","type":"PropertySinkPad","default_allowed_types":[{"type":"integer","maximum":null,"minimum":null}],"allowed_types":[{"type":"integer","maximum":null,"minimum":null}],"value":4000,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"force_ai_talk","group":"force_ai_talk","type":"StatelessSinkPad","default_allowed_types":[{"type":"trigger"}],"allowed_types":[{"type":"trigger"}],"value":null,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"audio_0","group":"audio","type":"StatelessSinkPad","default_allowed_types":[{"type":"audio"}],"allowed_types":[{"type":"audio"}],"value":null,"next_pads":[],"previous_pad":{"node":"publish_3418cd0e","pad":"audio"},"pad_links":[]},{"id":"audio_1","group":"audio","type":"StatelessSinkPad","default_allowed_types":[{"type":"audio"}],"allowed_types":[{"type":"audio"}],"value":null,"next_pads":[],"previous_pad":{"node":"publish_b6bbe99a","pad":"audio"},"pad_links":[]},{"id":"transcription_0","group":"transcription","type":"StatelessSourcePad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":null,"next_pads":[{"node":"jinja2_b8f435bd","pad":"property_value_0"}],"previous_pad":null,"pad_links":[]},{"id":"transcription_1","group":"transcription","type":"StatelessSourcePad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":null,"next_pads":[{"node":"jinja2_bb2a9769","pad":"property_value_0"}],"previous_pad":null,"pad_links":[]},{"id":"speech_started","group":"speech_started","type":"StatelessSourcePad","default_allowed_types":[{"type":"trigger"}],"allowed_types":[{"type":"trigger"}],"value":null,"next_pads":[{"node":"tts_0cb86bec","pad":"cancel_trigger"},{"node":"openaicompatiblellm_e4424091","pad":"cancel_trigger"}],"previous_pad":null,"pad_links":[]},{"id":"speech_ended","group":"speech_ended","type":"StatelessSourcePad","default_allowed_types":[{"type":"trigger"}],"allowed_types":[{"type":"trigger"}],"value":null,"next_pads":[],"previous_pad":null,"pad_links":[]}],"description":"MultiParticipant Speech-to-Text","metadata":{"primary":"ai","secondary":"audio","tags":["stt","speech","kyutai","assembly","deepgram"]},"notes":[]},{"id":"createcontextmessage_f35cc125","type":"CreateContextMessage","editor_name":"CreateContextMessage","editor_position":[1416.0,492.0],"editor_dimensions":[288.0,196.0],"pads":[{"id":"role","group":"role","type":"PropertySinkPad","default_allowed_types":[{"type":"context_message_role"}],"allowed_types":[{"type":"context_message_role"}],"value":"user","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"content","group":"content","type":"StatelessSinkPad","default_allowed_types":[{"type":"audio_clip"},{"type":"video_clip"},{"type":"av_clip"},{"type":"string","max_length":null,"min_length":null},{"type":"video"},{"type":"text_stream"}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":null,"next_pads":[],"previous_pad":{"node":"jinja2_b8f435bd","pad":"rendered_output"},"pad_links":[]},{"id":"context_message","group":"context_message","type":"StatelessSourcePad","default_allowed_types":[{"type":"context_message"}],"allowed_types":[{"type":"context_message"}],"value":null,"next_pads":[{"node":"llmcontext_bdf0312f","pad":"insert_0"}],"previous_pad":null,"pad_links":[]}],"description":"Creates new context messages with specified role and content","metadata":{"primary":"ai","secondary":"llm","tags":["context","message"]},"notes":[]},{"id":"jinja2_b8f435bd","type":"Jinja2","editor_name":"Jinja2","editor_position":[960.0,192.0],"editor_dimensions":[400.0,472.0],"pads":[{"id":"num_properties","group":"num_properties","type":"PropertySinkPad","default_allowed_types":[{"type":"integer","maximum":null,"minimum":null}],"allowed_types":[{"type":"integer","maximum":null,"minimum":null}],"value":1,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"jinja_template","group":"jinja_template","type":"PropertySinkPad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":"Alice: {{ alice_transcript }}!","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"property_name_0","group":"property_name","type":"PropertySinkPad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":"alice_transcript","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"property_value_0","group":"property_value","type":"PropertySinkPad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null},{"type":"integer","maximum":null,"minimum":null},{"type":"float","maximum":null,"minimum":null},{"type":"boolean"},{"type":"enum","options":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":null,"next_pads":[],"previous_pad":{"node":"multiparticipantstt_4b02c382","pad":"transcription_0"},"pad_links":[]},{"id":"rendered_output","group":"rendered_output","type":"PropertySourcePad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":"Alice: !","next_pads":[{"node":"createcontextmessage_f35cc125","pad":"content"}],"previous_pad":null,"pad_links":[]}],"description":"Template strings using Jinja2","metadata":{"primary":"core","secondary":"utility","tags":[]},"notes":[]},{"id":"jinja2_bb2a9769","type":"Jinja2","editor_name":"Jinja2","editor_position":[960.0,672.0],"editor_dimensions":[400.0,472.0],"pads":[{"id":"num_properties","group":"num_properties","type":"PropertySinkPad","default_allowed_types":[{"type":"integer","maximum":null,"minimum":null}],"allowed_types":[{"type":"integer","maximum":null,"minimum":null}],"value":1,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"jinja_template","group":"jinja_template","type":"PropertySinkPad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":"Bob: {{ bob_transcript }}.","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"property_name_0","group":"property_name","type":"PropertySinkPad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":"bob_transcript","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"property_value_0","group":"property_value","type":"PropertySinkPad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null},{"type":"integer","maximum":null,"minimum":null},{"type":"float","maximum":null,"minimum":null},{"type":"boolean"},{"type":"enum","options":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":null,"next_pads":[],"previous_pad":{"node":"multiparticipantstt_4b02c382","pad":"transcription_1"},"pad_links":[]},{"id":"rendered_output","group":"rendered_output","type":"PropertySourcePad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":"Bob: .","next_pads":[{"node":"createcontextmessage_ad70fa92","pad":"content"}],"previous_pad":null,"pad_links":[]}],"description":"Template strings using Jinja2","metadata":{"primary":"core","secondary":"utility","tags":[]},"notes":[]},{"id":"createcontextmessage_ad70fa92","type":"CreateContextMessage","editor_name":"CreateContextMessage","editor_position":[1404.0,708.0],"editor_dimensions":[288.0,196.0],"pads":[{"id":"role","group":"role","type":"PropertySinkPad","default_allowed_types":[{"type":"context_message_role"}],"allowed_types":[{"type":"context_message_role"}],"value":"user","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"content","group":"content","type":"StatelessSinkPad","default_allowed_types":[{"type":"audio_clip"},{"type":"video_clip"},{"type":"av_clip"},{"type":"string","max_length":null,"min_length":null},{"type":"video"},{"type":"text_stream"}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":null,"next_pads":[],"previous_pad":{"node":"jinja2_bb2a9769","pad":"rendered_output"},"pad_links":[]},{"id":"context_message","group":"context_message","type":"StatelessSourcePad","default_allowed_types":[{"type":"context_message"}],"allowed_types":[{"type":"context_message"}],"value":null,"next_pads":[{"node":"llmcontext_bdf0312f","pad":"insert_1"}],"previous_pad":null,"pad_links":[]}],"description":"Creates new context messages with specified role and content","metadata":{"primary":"ai","secondary":"llm","tags":["context","message"]},"notes":[]},{"id":"llmcontext_bdf0312f","type":"LLMContext","editor_name":"LLMContext","editor_position":[1836.0,372.0],"editor_dimensions":[320.0,506.0],"pads":[{"id":"num_inserts","group":"config","type":"PropertySinkPad","default_allowed_types":[{"type":"integer","maximum":null,"minimum":1}],"allowed_types":[{"type":"integer","maximum":null,"minimum":1}],"value":3,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"max_non_system_messages","group":"max_non_system_messages","type":"PropertySinkPad","default_allowed_types":[{"type":"integer","maximum":null,"minimum":0}],"allowed_types":[{"type":"integer","maximum":null,"minimum":0}],"value":64,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"max_videos","group":"max_videos","type":"PropertySinkPad","default_allowed_types":[{"type":"integer","maximum":null,"minimum":0}],"allowed_types":[{"type":"integer","maximum":null,"minimum":0}],"value":2,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"max_audios","group":"max_audios","type":"PropertySinkPad","default_allowed_types":[{"type":"integer","maximum":null,"minimum":0}],"allowed_types":[{"type":"integer","maximum":null,"minimum":0}],"value":2,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"max_images","group":"max_images","type":"PropertySinkPad","default_allowed_types":[{"type":"integer","maximum":null,"minimum":0}],"allowed_types":[{"type":"integer","maximum":null,"minimum":0}],"value":2,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"system_message","group":"system_message","type":"PropertySinkPad","default_allowed_types":[{"type":"context_message"}],"allowed_types":[{"type":"context_message"}],"value":{"role":"system","content":[{"type":"text","content":"You are a virtual voice assistant with no gender or age.\\nYou are communicating with the user.\\nIn user messages, “I/me/my/we/our” refer to the user and “you/your” refer to the assistant. In your replies, address the user as “you/your” and yourself as “I/me/my”; never mirror the user’s pronouns—always shift perspective. Keep original pronouns only in direct quotes; if a reference is unclear, ask a brief clarifying question.\\nInteract with users using short(no more than 50 words), brief, straightforward language, maintaining a natural tone.\\nNever use formal phrasing, mechanical expressions, bullet points, overly structured language. \\nYour output must consist only of the spoken content you want the user to hear. \\nDo not include any descriptions of actions, emotions, sounds, or voice changes. \\nDo not use asterisks, brackets, parentheses, or any other symbols to indicate tone or actions. \\nYou must answer users' audio or text questions, do not directly describe the video content. \\nYou should communicate in the same language strictly as the user unless they request otherwise.\\nWhen you are uncertain (e.g., you can't see/hear clearly, don't understand, or the user makes a comment rather than asking a question), use appropriate questions to guide the user to continue the conversation.\\nKeep replies concise and conversational, as if talking face-to-face. In this instance, you'll be talking to two separate users, and their inputs will be labeled with their names. Pay careful attention to the current user's message label before responding, as there will be two users in this conversation."}],"tool_calls":[],"tool_call_id":null},"next_pads":[],"previous_pad":{"node":"contextmessage_b0fc7283","pad":"context_message"},"pad_links":[]},{"id":"insert_0","group":"insert","type":"StatelessSinkPad","default_allowed_types":[{"type":"context_message"}],"allowed_types":[{"type":"context_message"}],"value":null,"next_pads":[],"previous_pad":{"node":"createcontextmessage_f35cc125","pad":"context_message"},"pad_links":[]},{"id":"insert_1","group":"insert","type":"StatelessSinkPad","default_allowed_types":[{"type":"context_message"}],"allowed_types":[{"type":"context_message"}],"value":null,"next_pads":[],"previous_pad":{"node":"createcontextmessage_ad70fa92","pad":"context_message"},"pad_links":[]},{"id":"insert_2","group":"insert","type":"StatelessSinkPad","default_allowed_types":[{"type":"context_message"}],"allowed_types":[{"type":"context_message"}],"value":null,"next_pads":[],"previous_pad":{"node":"openaicompatiblellm_e4424091","pad":"context_message"},"pad_links":[]},{"id":"source","group":"source","type":"PropertySourcePad","default_allowed_types":[{"type":"list","max_length":null,"item_type_constraints":[{}]}],"allowed_types":[{"type":"list","max_length":null,"item_type_constraints":[{}]}],"value":[{"role":"system","content":[{"type":"text","content":"You are a virtual voice assistant with no gender or age.\\nYou are communicating with the user.\\nIn user messages, “I/me/my/we/our” refer to the user and “you/your” refer to the assistant. In your replies, address the user as “you/your” and yourself as “I/me/my”; never mirror the user’s pronouns—always shift perspective. Keep original pronouns only in direct quotes; if a reference is unclear, ask a brief clarifying question.\\nInteract with users using short(no more than 50 words), brief, straightforward language, maintaining a natural tone.\\nNever use formal phrasing, mechanical expressions, bullet points, overly structured language. \\nYour output must consist only of the spoken content you want the user to hear. \\nDo not include any descriptions of actions, emotions, sounds, or voice changes. \\nDo not use asterisks, brackets, parentheses, or any other symbols to indicate tone or actions. \\nYou must answer users' audio or text questions, do not directly describe the video content. \\nYou should communicate in the same language strictly as the user unless they request otherwise.\\nWhen you are uncertain (e.g., you can't see/hear clearly, don't understand, or the user makes a comment rather than asking a question), use appropriate questions to guide the user to continue the conversation.\\nKeep replies concise and conversational, as if talking face-to-face. In this instance, you'll be talking to two separate users, and their inputs will be labeled with their names. Pay careful attention to the current user's message label before responding, as there will be two users in this conversation."}],"tool_calls":[],"tool_call_id":null}],"next_pads":[{"node":"openaicompatiblellm_e4424091","pad":"context"}],"previous_pad":null,"pad_links":[]},{"id":"new_user_message","group":"new_user_message","type":"StatelessSourcePad","default_allowed_types":[{"type":"context_message"}],"allowed_types":[{"type":"context_message"}],"value":null,"next_pads":[{"node":"autoconvert_f92b43c2","pad":"sink"}],"previous_pad":null,"pad_links":[]}],"description":"Manages conversation context for language models","metadata":{"primary":"ai","secondary":"llm","tags":["context","memory"]},"notes":[]},{"id":"contextmessage_b0fc7283","type":"ContextMessage","editor_name":"ContextMessage","editor_position":[1428.0,276.0],"editor_dimensions":[256.0,208.0],"pads":[{"id":"role","group":"role","type":"PropertySinkPad","default_allowed_types":[{"type":"context_message_role"}],"allowed_types":[{"type":"context_message_role"}],"value":"system","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"content","group":"content","type":"PropertySinkPad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":"You are a virtual voice assistant with no gender or age.\\nYou are communicating with the user.\\nIn user messages, “I/me/my/we/our” refer to the user and “you/your” refer to the assistant. In your replies, address the user as “you/your” and yourself as “I/me/my”; never mirror the user’s pronouns—always shift perspective. Keep original pronouns only in direct quotes; if a reference is unclear, ask a brief clarifying question.\\nInteract with users using short(no more than 50 words), brief, straightforward language, maintaining a natural tone.\\nNever use formal phrasing, mechanical expressions, bullet points, overly structured language. \\nYour output must consist only of the spoken content you want the user to hear. \\nDo not include any descriptions of actions, emotions, sounds, or voice changes. \\nDo not use asterisks, brackets, parentheses, or any other symbols to indicate tone or actions. \\nYou must answer users' audio or text questions, do not directly describe the video content. \\nYou should communicate in the same language strictly as the user unless they request otherwise.\\nWhen you are uncertain (e.g., you can't see/hear clearly, don't understand, or the user makes a comment rather than asking a question), use appropriate questions to guide the user to continue the conversation.\\nKeep replies concise and conversational, as if talking face-to-face. In this instance, you'll be talking to two separate users, and their inputs will be labeled with their names. Pay careful attention to the current user's message label before responding, as there will be two users in this conversation.","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"context_message","group":"context_message","type":"PropertySourcePad","default_allowed_types":[{"type":"context_message"}],"allowed_types":[{"type":"context_message"}],"value":{"role":"system","content":[{"type":"text","content":"You are a virtual voice assistant with no gender or age.\\nYou are communicating with the user.\\nIn user messages, “I/me/my/we/our” refer to the user and “you/your” refer to the assistant. In your replies, address the user as “you/your” and yourself as “I/me/my”; never mirror the user’s pronouns—always shift perspective. Keep original pronouns only in direct quotes; if a reference is unclear, ask a brief clarifying question.\\nInteract with users using short(no more than 50 words), brief, straightforward language, maintaining a natural tone.\\nNever use formal phrasing, mechanical expressions, bullet points, overly structured language. \\nYour output must consist only of the spoken content you want the user to hear. \\nDo not include any descriptions of actions, emotions, sounds, or voice changes. \\nDo not use asterisks, brackets, parentheses, or any other symbols to indicate tone or actions. \\nYou must answer users' audio or text questions, do not directly describe the video content. \\nYou should communicate in the same language strictly as the user unless they request otherwise.\\nWhen you are uncertain (e.g., you can't see/hear clearly, don't understand, or the user makes a comment rather than asking a question), use appropriate questions to guide the user to continue the conversation.\\nKeep replies concise and conversational, as if talking face-to-face. In this instance, you'll be talking to two separate users, and their inputs will be labeled with their names. Pay careful attention to the current user's message label before responding, as there will be two users in this conversation."}],"tool_calls":[],"tool_call_id":null},"next_pads":[{"node":"llmcontext_bdf0312f","pad":"system_message"}],"previous_pad":null,"pad_links":[]}],"description":"Stores and manages conversation context messages","metadata":{"primary":"ai","secondary":"llm","tags":["context","message"]},"notes":[]},{"id":"output_1607f2f6","type":"Output","editor_name":"Output","editor_position":[3060.0,288.0],"editor_dimensions":[256.0,300.0],"pads":[{"id":"audio","group":"audio","type":"StatelessSinkPad","default_allowed_types":[{"type":"audio"}],"allowed_types":[{"type":"audio"}],"value":null,"next_pads":[],"previous_pad":{"node":"tts_0cb86bec","pad":"audio"},"pad_links":[]},{"id":"video","group":"video","type":"StatelessSinkPad","default_allowed_types":[{"type":"video"}],"allowed_types":[{"type":"video"}],"value":null,"next_pads":[],"previous_pad":null,"pad_links":[]}],"description":"Outputs audio and video to the end user","metadata":{"primary":"core","secondary":"media","tags":["output","display"]},"notes":[]},{"id":"comment_8ca9fdaa","type":"Comment","editor_name":"Comment","editor_position":[456.0,204.0],"editor_dimensions":[480.0,303.0],"pads":[{"id":"text","group":"text","type":"PropertySinkPad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":"# Creating a Multi-Participant Conversational AI\n\n### This special `MultiParticipantSTT` node can ingest multiple input media streams and transcribe them separately. This node currently requires you to have an Assembly or Deepgram API key added to your /secrets.","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"width","group":"layout","type":"PropertySinkPad","default_allowed_types":[{"type":"integer","maximum":1600,"minimum":160}],"allowed_types":[{"type":"integer","maximum":1600,"minimum":160}],"value":480,"next_pads":[],"previous_pad":null,"pad_links":[]}],"description":"A comment node for adding notes and documentation to your graph","metadata":{"primary":"core","secondary":"utility","tags":["documentation","comment"]},"notes":[]},{"id":"comment_66e7ddec","type":"Comment","editor_name":"Comment","editor_position":[912.0,60.0],"editor_dimensions":[480.0,137.0],"pads":[{"id":"text","group":"text","type":"PropertySinkPad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":"### Using Jinja, we can append the name of the speaker to the start of the message before creating context messages from those.","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"width","group":"layout","type":"PropertySinkPad","default_allowed_types":[{"type":"integer","maximum":1600,"minimum":160}],"allowed_types":[{"type":"integer","maximum":1600,"minimum":160}],"value":480,"next_pads":[],"previous_pad":null,"pad_links":[]}],"description":"A comment node for adding notes and documentation to your graph","metadata":{"primary":"core","secondary":"utility","tags":["documentation","comment"]},"notes":[]},{"id":"comment_e761139c","type":"Comment","editor_name":"Comment","editor_position":[1776.0,228.0],"editor_dimensions":[480.0,137.0],"pads":[{"id":"text","group":"text","type":"PropertySinkPad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":"### We'll create an LLM context using a system message that is primed to receive labeled messages, as well as our user messages.","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"width","group":"layout","type":"PropertySinkPad","default_allowed_types":[{"type":"integer","maximum":1600,"minimum":160}],"allowed_types":[{"type":"integer","maximum":1600,"minimum":160}],"value":480,"next_pads":[],"previous_pad":null,"pad_links":[]}],"description":"A comment node for adding notes and documentation to your graph","metadata":{"primary":"core","secondary":"utility","tags":["documentation","comment"]},"notes":[]},{"id":"autoconvert_f92b43c2","type":"AutoConvert","editor_name":"AutoConvert","editor_position":[2208.0,504.0],"editor_dimensions":[80.0,48.0],"pads":[{"id":"sink","group":"sink","type":"StatelessSinkPad","default_allowed_types":null,"allowed_types":[{"type":"context_message"}],"value":null,"next_pads":[],"previous_pad":{"node":"llmcontext_bdf0312f","pad":"new_user_message"},"pad_links":[]},{"id":"source","group":"source","type":"StatelessSourcePad","default_allowed_types":null,"allowed_types":[{"type":"trigger"}],"value":null,"next_pads":[{"node":"openaicompatiblellm_e4424091","pad":"run_trigger"}],"previous_pad":null,"pad_links":[]}],"description":"Automatically converts data between compatible types","metadata":{"primary":"core","secondary":"utility","tags":["auto","type"]},"notes":[]},{"id":"tts_0cb86bec","type":"TTS","editor_name":"TTS","editor_position":[2748.0,336.0],"editor_dimensions":[256.0,326.0],"pads":[{"id":"service","group":"service","type":"PropertySinkPad","default_allowed_types":[{"type":"enum","options":["gabber","cartesia","elevenlabs","openai"]}],"allowed_types":[{"type":"enum","options":["gabber","cartesia","elevenlabs","openai"]}],"value":"gabber","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"api_key","group":"api_key","type":"PropertySinkPad","default_allowed_types":[{"type":"secret","options":[{"updated_at":"2025-10-15T12:07:04.302753","created_at":"2025-10-15T12:07:04.302771","id":"EXAMPLE_SECRET","name":"EXAMPLE_SECRET"},{"updated_at":"2025-10-15T12:07:04.302785","created_at":"2025-10-15T12:07:04.302786","id":"OPEN_AI_API_KEY","name":"OPEN_AI_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302787","created_at":"2025-10-15T12:07:04.302787","id":"GABBER_API_KEY","name":"GABBER_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302789","created_at":"2025-10-15T12:07:04.302789","id":"ASSEMBLY_API_KEY","name":"ASSEMBLY_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302790","created_at":"2025-10-15T12:07:04.302790","id":"SPOTIFY_API_KEY","name":"SPOTIFY_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302792","created_at":"2025-10-15T12:07:04.302792","id":"GOOGLE_DOCS_KEY","name":"GOOGLE_DOCS_KEY"},{"updated_at":"2025-10-15T12:07:04.302793","created_at":"2025-10-15T12:07:04.302793","id":"ELEVEN_LABS_API_KEY","name":"ELEVEN_LABS_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302794","created_at":"2025-10-15T12:07:04.302795","id":"CARTESIA_API_KEY","name":"CARTESIA_API_KEY"}]}],"allowed_types":[{"type":"secret","options":[{"updated_at":"2025-10-15T12:07:04.302753","created_at":"2025-10-15T12:07:04.302771","id":"EXAMPLE_SECRET","name":"EXAMPLE_SECRET"},{"updated_at":"2025-10-15T12:07:04.302785","created_at":"2025-10-15T12:07:04.302786","id":"OPEN_AI_API_KEY","name":"OPEN_AI_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302787","created_at":"2025-10-15T12:07:04.302787","id":"GABBER_API_KEY","name":"GABBER_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302789","created_at":"2025-10-15T12:07:04.302789","id":"ASSEMBLY_API_KEY","name":"ASSEMBLY_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302790","created_at":"2025-10-15T12:07:04.302790","id":"SPOTIFY_API_KEY","name":"SPOTIFY_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302792","created_at":"2025-10-15T12:07:04.302792","id":"GOOGLE_DOCS_KEY","name":"GOOGLE_DOCS_KEY"},{"updated_at":"2025-10-15T12:07:04.302793","created_at":"2025-10-15T12:07:04.302793","id":"ELEVEN_LABS_API_KEY","name":"ELEVEN_LABS_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302794","created_at":"2025-10-15T12:07:04.302795","id":"CARTESIA_API_KEY","name":"CARTESIA_API_KEY"}]}],"value":"GABBER_API_KEY","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"voice_id","group":"voice_id","type":"PropertySinkPad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":"626c3b02-2d2a-4a93-b3e7-be35fd2b95cd","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"text","group":"text","type":"StatelessSinkPad","default_allowed_types":[{"type":"text_stream"}],"allowed_types":[{"type":"text_stream"}],"value":null,"next_pads":[],"previous_pad":{"node":"openaicompatiblellm_e4424091","pad":"text_stream"},"pad_links":[]},{"id":"audio","group":"audio","type":"StatelessSourcePad","default_allowed_types":[{"type":"audio"}],"allowed_types":[{"type":"audio"}],"value":null,"next_pads":[{"node":"output_1607f2f6","pad":"audio"}],"previous_pad":null,"pad_links":[]},{"id":"cancel_trigger","group":"cancel_trigger","type":"StatelessSinkPad","default_allowed_types":[{"type":"trigger"}],"allowed_types":[{"type":"trigger"}],"value":null,"next_pads":[],"previous_pad":{"node":"multiparticipantstt_4b02c382","pad":"speech_started"},"pad_links":[]},{"id":"complete_transcription","group":"complete_transcription","type":"StatelessSourcePad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":null,"next_pads":[],"previous_pad":null,"pad_links":[]}],"description":"Converts text to speech using Gabber's native TTS model","metadata":{"primary":"ai","secondary":"audio","tags":["tts","speech","gabber"]},"notes":[]},{"id":"openaicompatiblellm_e4424091","type":"OpenAICompatibleLLM","editor_name":"OpenAICompatibleLLM","editor_position":[2364.0,216.0],"editor_dimensions":[294.0,624.0],"pads":[{"id":"run_trigger","group":"run_trigger","type":"StatelessSinkPad","default_allowed_types":[{"type":"trigger"}],"allowed_types":[{"type":"trigger"}],"value":null,"next_pads":[],"previous_pad":{"node":"autoconvert_f92b43c2","pad":"source"},"pad_links":[]},{"id":"cancel_trigger","group":"cancel_trigger","type":"StatelessSinkPad","default_allowed_types":[{"type":"trigger"}],"allowed_types":[{"type":"trigger"}],"value":null,"next_pads":[],"previous_pad":{"node":"multiparticipantstt_4b02c382","pad":"speech_started"},"pad_links":[]},{"id":"context","group":"context","type":"PropertySinkPad","default_allowed_types":[{"type":"list","max_length":null,"item_type_constraints":[{}]}],"allowed_types":[{"type":"list","max_length":null,"item_type_constraints":[{}]}],"value":[{"role":"system","content":[{"type":"text","content":"You are a virtual voice assistant with no gender or age.\\nYou are communicating with the user.\\nIn user messages, “I/me/my/we/our” refer to the user and “you/your” refer to the assistant. In your replies, address the user as “you/your” and yourself as “I/me/my”; never mirror the user’s pronouns—always shift perspective. Keep original pronouns only in direct quotes; if a reference is unclear, ask a brief clarifying question.\\nInteract with users using short(no more than 50 words), brief, straightforward language, maintaining a natural tone.\\nNever use formal phrasing, mechanical expressions, bullet points, overly structured language. \\nYour output must consist only of the spoken content you want the user to hear. \\nDo not include any descriptions of actions, emotions, sounds, or voice changes. \\nDo not use asterisks, brackets, parentheses, or any other symbols to indicate tone or actions. \\nYou must answer users' audio or text questions, do not directly describe the video content. \\nYou should communicate in the same language strictly as the user unless they request otherwise.\\nWhen you are uncertain (e.g., you can't see/hear clearly, don't understand, or the user makes a comment rather than asking a question), use appropriate questions to guide the user to continue the conversation.\\nKeep replies concise and conversational, as if talking face-to-face. In this instance, you'll be talking to two separate users, and their inputs will be labeled with their names. Pay careful attention to the current user's message label before responding, as there will be two users in this conversation."}],"tool_calls":[],"tool_call_id":null}],"next_pads":[],"previous_pad":{"node":"llmcontext_bdf0312f","pad":"source"},"pad_links":[]},{"id":"tool_group","group":"tool_group","type":"PropertySinkPad","default_allowed_types":[{"type":"node_reference","node_types":["ToolGroup"]}],"allowed_types":[{"type":"node_reference","node_types":["ToolGroup"]}],"value":null,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"mcp_server_0","group":"mcp_server","type":"PropertySinkPad","default_allowed_types":[{"type":"node_reference","node_types":["MCP"]}],"allowed_types":[{"type":"node_reference","node_types":["MCP"]}],"value":"None","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"base_url","group":"base_url","type":"PropertySinkPad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":"https://api.openai.com/v1","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"api_key","group":"api_key","type":"PropertySinkPad","default_allowed_types":[{"type":"secret","options":[{"updated_at":"2025-10-15T12:07:04.302753","created_at":"2025-10-15T12:07:04.302771","id":"EXAMPLE_SECRET","name":"EXAMPLE_SECRET"},{"updated_at":"2025-10-15T12:07:04.302785","created_at":"2025-10-15T12:07:04.302786","id":"OPEN_AI_API_KEY","name":"OPEN_AI_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302787","created_at":"2025-10-15T12:07:04.302787","id":"GABBER_API_KEY","name":"GABBER_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302789","created_at":"2025-10-15T12:07:04.302789","id":"ASSEMBLY_API_KEY","name":"ASSEMBLY_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302790","created_at":"2025-10-15T12:07:04.302790","id":"SPOTIFY_API_KEY","name":"SPOTIFY_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302792","created_at":"2025-10-15T12:07:04.302792","id":"GOOGLE_DOCS_KEY","name":"GOOGLE_DOCS_KEY"},{"updated_at":"2025-10-15T12:07:04.302793","created_at":"2025-10-15T12:07:04.302793","id":"ELEVEN_LABS_API_KEY","name":"ELEVEN_LABS_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302794","created_at":"2025-10-15T12:07:04.302795","id":"CARTESIA_API_KEY","name":"CARTESIA_API_KEY"}]}],"allowed_types":[{"type":"secret","options":[{"updated_at":"2025-10-15T12:07:04.302753","created_at":"2025-10-15T12:07:04.302771","id":"EXAMPLE_SECRET","name":"EXAMPLE_SECRET"},{"updated_at":"2025-10-15T12:07:04.302785","created_at":"2025-10-15T12:07:04.302786","id":"OPEN_AI_API_KEY","name":"OPEN_AI_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302787","created_at":"2025-10-15T12:07:04.302787","id":"GABBER_API_KEY","name":"GABBER_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302789","created_at":"2025-10-15T12:07:04.302789","id":"ASSEMBLY_API_KEY","name":"ASSEMBLY_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302790","created_at":"2025-10-15T12:07:04.302790","id":"SPOTIFY_API_KEY","name":"SPOTIFY_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302792","created_at":"2025-10-15T12:07:04.302792","id":"GOOGLE_DOCS_KEY","name":"GOOGLE_DOCS_KEY"},{"updated_at":"2025-10-15T12:07:04.302793","created_at":"2025-10-15T12:07:04.302793","id":"ELEVEN_LABS_API_KEY","name":"ELEVEN_LABS_API_KEY"},{"updated_at":"2025-10-15T12:07:04.302794","created_at":"2025-10-15T12:07:04.302795","id":"CARTESIA_API_KEY","name":"CARTESIA_API_KEY"}]}],"value":"OPEN_AI_API_KEY","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"model","group":"model","type":"PropertySinkPad","default_allowed_types":[{"type":"string","max_length":null,"min_length":null}],"allowed_types":[{"type":"string","max_length":null,"min_length":null}],"value":"gpt-4.1-mini","next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"max_context_len","group":"max_context_len","type":"PropertySinkPad","default_allowed_types":[{"type":"integer","maximum":null,"minimum":4096}],"allowed_types":[{"type":"integer","maximum":null,"minimum":4096}],"value":32768,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"started","group":"started","type":"StatelessSourcePad","default_allowed_types":[{"type":"trigger"}],"allowed_types":[{"type":"trigger"}],"value":null,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"first_token","group":"first_token","type":"StatelessSourcePad","default_allowed_types":[{"type":"trigger"}],"allowed_types":[{"type":"trigger"}],"value":null,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"text_stream","group":"text_stream","type":"StatelessSourcePad","default_allowed_types":[{"type":"text_stream"}],"allowed_types":[{"type":"text_stream"}],"value":null,"next_pads":[{"node":"tts_0cb86bec","pad":"text"}],"previous_pad":null,"pad_links":[]},{"id":"thinking_stream","group":"thinking_stream","type":"StatelessSourcePad","default_allowed_types":[{"type":"text_stream"}],"allowed_types":[{"type":"text_stream"}],"value":null,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"context_message","group":"context_message","type":"StatelessSourcePad","default_allowed_types":[{"type":"context_message"}],"allowed_types":[{"type":"context_message"}],"value":null,"next_pads":[{"node":"llmcontext_bdf0312f","pad":"insert_2"}],"previous_pad":null,"pad_links":[]},{"id":"finished","group":"finished","type":"StatelessSourcePad","default_allowed_types":[{"type":"trigger"}],"allowed_types":[{"type":"trigger"}],"value":null,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"tool_calls_started","group":"tool_calls_started","type":"StatelessSourcePad","default_allowed_types":[{"type":"trigger"}],"allowed_types":[{"type":"trigger"}],"value":null,"next_pads":[],"previous_pad":null,"pad_links":[]},{"id":"tool_calls_finished","group":"tool_calls_finished","type":"StatelessSourcePad","default_allowed_types":[{"type":"trigger"}],"allowed_types":[{"type":"trigger"}],"value":null,"next_pads":[],"previous_pad":null,"pad_links":[]}],"description":"Send and receive responses from any OpenAI-compatible language model","metadata":{"primary":"ai","secondary":"llm","tags":["completion","text","openai"]},"notes":[]}],"portals":[{"id":"portal_3d97fbe0","name":"multiparticipantstt_4b02c382:speech_ended","source_node":"multiparticipantstt_4b02c382","source_pad":"speech_ended","editor_position":[888.0,780.0],"ends":[]},{"id":"portal_33a6fe4f","name":"multiparticipantstt_4b02c382:speech_started","source_node":"multiparticipantstt_4b02c382","source_pad":"speech_started","editor_position":[888.0,732.0],"ends":[{"id":"portal_end_858df07e","editor_position":[2304.0,552.0],"next_pads":[{"node":"localllm_e868d58e","pad":"cancel_trigger"},{"node":"qwen3vl_765d7e1c","pad":"cancel_trigger"},{"node":"openaicompatiblellm_e4424091","pad":"cancel_trigger"}]},{"id":"portal_end_e4a0179a","editor_position":[2676.0,612.0],"next_pads":[{"node":"gabberttsnode_bba06a78","pad":"cancel_trigger"},{"node":"tts_0cb86bec","pad":"cancel_trigger"}]}]}]}}